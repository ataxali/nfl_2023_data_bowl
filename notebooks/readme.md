just dumping my messy code here for reference
i NEED to clean things up, quite incoherent to an outsider
